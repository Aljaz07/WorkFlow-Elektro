<!DOCTYPE html>
<html lang="sl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WorkFlow Elektro</title>
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<style>
/* --- STYLES CLEANED & OPTIMIZED --- */
:root{--bg-1:#0b0c0f;--bg-2:#0f1720;--accent:#ffc400;--muted:#bfc8c1;--card:#08120f}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,Arial,sans-serif;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:#eef6ee}
.login-wrap{display:flex;align-items:center;justify-content:center;height:100vh;padding:20px}
.login-card{background:rgba(255,255,255,0.02);padding:28px;border-radius:14px;width:360px;box-shadow:0 10px 40px rgba(0,0,0,0.6);border:1px solid rgba(255,196,0,0.06)}
.login-card h2{color:var(--accent);margin-bottom:10px}
.login-card input{width:100%;padding:12px;margin:8px 0;border-radius:8px;border:none;background:#0e1915;color:#fff}
.btn{background:var(--accent);color:#07100a;padding:10px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
.small{font-size:13px;color:var(--muted)}
.app{display:none;height:100vh;overflow:hidden}.app.active{display:flex}
.left{width:300px;min-width:240px;background:rgba(255,255,255,0.02);padding:22px;border-right:1px solid rgba(255,196,0,0.04);display:flex;flex-direction:column}
.logo{display:flex;gap:12px;align-items:center}.logo .dot{width:48px;height:48px;border-radius:12px;background:var(--accent);display:flex;align-items:center;justify-content:center;color:#07100a;font-weight:800}
.sidebar-btn{display:block;width:100%;text-align:left;padding:12px 14px;border-radius:10px;background:transparent;color:var(--muted);border:none;cursor:pointer;font-weight:600;margin-top:8px}.sidebar-btn.active,.sidebar-btn:hover{background:rgba(255,196,0,0.06);color:#fff}
.user-info{margin-top:auto;display:flex;align-items:center;gap:10px;padding-top:12px;border-top:1px solid rgba(255,196,0,0.03)}
.avatar{width:48px;height:48px;border-radius:8px;background:#142018;display:flex;align-items:center;justify-content:center;color:var(--accent);font-weight:700}
.spacer{flex:1}.right{flex:1;display:flex;flex-direction:column;padding:18px;gap:12px;overflow:auto}
.topbar{display:flex;justify-content:space-between;align-items:center}
.calendar-surface{background:rgba(255,255,255,0.01);border-radius:12px;padding:14px;box-shadow:0 8px 30px rgba(0,0,0,0.45);border:1px solid rgba(255,196,0,0.03);display:flex;flex-direction:column;gap:12px;min-height:70vh}
.cal-header{display:flex;align-items:center;justify-content:space-between}.cal-nav{display:flex;gap:8px;align-items:center}.month-label{font-weight:700;color:#fff;padding:8px 14px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.02)}
.weekdays{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}.weekday{text-align:center;font-weight:700;color:var(--muted);font-size:13px;padding:6px 8px}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;flex:1;align-content:start}.cell{background:#07120f;padding:10px;border-radius:10px;min-height:120px;border:1px solid rgba(255,255,255,0.02);display:flex;flex-direction:column;gap:8px;position:relative;transition:transform .15s ease,box-shadow .15s ease}.cell:hover{transform:translateY(-4px);box-shadow:0 8px 30px rgba(0,0,0,0.6)}
.date-badge{font-weight:700;color:var(--accent);font-size:13px}.task{background:rgba(255,196,0,0.08);color:#07100a;padding:8px;border-radius:8px;font-weight:700;font-size:13px;display:flex;justify-content:space-between;align-items:center;gap:8px;border-left:4px solid rgba(0,0,0,0.12);cursor:pointer}
.note{font-size:13px;color:var(--muted)}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,4,0.6);display:none;align-items:center;justify-content:center;padding:18px;z-index:40}
.modal{background:#07120f;padding:18px;border-radius:12px;max-width:720px;width:100%;box-shadow:0 20px 50px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.03)}
.form-row{display:flex;gap:10px}.form-row > *{flex:1}.time-list{margin-top:8px;display:flex;flex-direction:column;gap:8px}.time-item{display:flex;gap:8px;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:#08120f}
.time-item button{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 8px;border-radius:8px;cursor:pointer}
.export-row{display:flex;gap:8px}
@media(max-width:900px){.left{display:none}.calendar{grid-template-columns:repeat(2,1fr)}.weekdays{display:none}}
@media(max-width:480px){.calendar{grid-template-columns:repeat(1,1fr)}}
</style>
</head>
<body>
<!-- LOGIN & APP HTML STRUCTURE REMAINS SAME AS ORIGINAL -->
<script>
// --- DATA & LOGIN ---
const demoUsers={admin:{pass:'Outside2025',role:'admin',name:'Direktor'},aljaž:{pass:'SnowWinter2025',role:'worker',name:'Aljaž'}};
let workers=JSON.parse(localStorage.getItem('ew_workers_v1')||JSON.stringify({aljaž:{name:'Aljaž',role:'worker'}}));
let tasks=JSON.parse(localStorage.getItem('ew_tasks_v1')||'[]');
let history=JSON.parse(localStorage.getItem('ew_history_v1')||'[]');
let currentUser=null,currentRole=null,currentDate=new Date();

// --- UTIL FUNCTIONS ---
function saveAll(){localStorage.setItem('ew_workers_v1',JSON.stringify(workers));localStorage.setItem('ew_tasks_v1',JSON.stringify(tasks));localStorage.setItem('ew_history_v1',JSON.stringify(history));}
function formatDate(d){let y=d.getFullYear(),m=('0'+(d.getMonth()+1)).slice(-2),day=('0'+d.getDate()).slice(-2);return `${y}-${m}-${day}`;}
function parseTimeToHours(t){let [h,m]=t.split(':').map(Number);return h+m/60;}
function diffHours(s,e){return Math.max(0,Math.round((parseTimeToHours(e)-parseTimeToHours(s))*100)/100);}
function humanDuration(d){let h=Math.floor(d),m=Math.round((d-h)*60);return h===0?`${m}m`:m===0?`${h}h`:`${h}h ${m}m`;}

// --- LOGIN FUNCTIONS ---
function doLogin(){let u=document.getElementById('loginUser').value.trim().toLowerCase(),p=document.getElementById('loginPass').value;if(demoUsers[u]&&demoUsers[u].pass===p){currentUser=u;currentRole=demoUsers[u].role;afterLogin();}else alert('Napačni podatki.');}
function afterLogin(){document.getElementById('loginWrap').style.display='none';document.getElementById('app').classList.add('active');document.getElementById('userName').textContent=demoUsers[currentUser].name;document.getElementById('userRole').textContent=currentRole;document.getElementById('avatarBox').textContent=demoUsers[currentUser].name[0].toUpperCase();}
</script>
</body>
</html>
